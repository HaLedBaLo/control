function bb3d_M(ex, ey, ez)
	return [I_bi/r_b^2 + 1.5*I_wi*sin(ey)^2/r_w^2 + 0.75*I_wi*sin(ez)^2*cos(ey)^2/r_w^2 + 3*I_wi*cos(ey)^2*cos(ez)^2/(4*r_w^2) + m_b + m_t 0.75*I_wi*sin(ex)*sin(ey)*sin(ez)^2*cos(ey)/r_w^2 + 3*I_wi*sin(ex)*sin(ey)*cos(ey)*cos(ez)^2/(4*r_w^2) - 1.5*I_wi*sin(ex)*sin(ey)*cos(ey)/r_w^2 -3*I_wi*r_b*cos(ey)*cos(ez)/(4*r_w^2) - lz*m_t*sin(ex)*sin(ey)*cos(ez) + lz*m_t*sin(ez)*cos(ex) -0.75*I_wi*r_b*sin(ez)*cos(ey)/r_w^2 + lz*m_t*cos(ex)*cos(ey)*cos(ez) 1.5*I_wi*r_b*sin(ey)/r_w^2 + lz*m_t*sin(ex)*cos(ez) - lz*m_t*sin(ey)*sin(ez)*cos(ex); 0.75*I_wi*sin(ex)*sin(ey)*sin(ez)^2*cos(ey)/r_w^2 + 3*I_wi*sin(ex)*sin(ey)*cos(ey)*cos(ez)^2/(4*r_w^2) - 1.5*I_wi*sin(ex)*sin(ey)*cos(ey)/r_w^2 I_bi/r_b^2 + 0.75*I_wi*sin(ex)^2*sin(ey)^2*sin(ez)^2/r_w^2 + 3*I_wi*sin(ex)^2*sin(ey)^2*cos(ez)^2/(4*r_w^2) + 1.5*I_wi*sin(ex)^2*cos(ey)^2/r_w^2 + 3*I_wi*sin(ez)^2*cos(ex)^2/(4*r_w^2) + 0.75*I_wi*cos(ex)^2*cos(ez)^2/r_w^2 + m_b + m_t -3*I_wi*r_b*sin(ex)*sin(ey)*cos(ez)/(4*r_w^2) + 3*I_wi*r_b*sin(ez)*cos(ex)/(4*r_w^2) - lz*m_t*sin(ex)*sin(ey)*sin(ez) - lz*m_t*cos(ex)*cos(ez) -0.75*I_wi*r_b*sin(ex)*sin(ey)*sin(ez)/r_w^2 - 0.75*I_wi*r_b*cos(ex)*cos(ez)/r_w^2 + lz*m_t*sin(ez)*cos(ex)*cos(ey) -1.5*I_wi*r_b*sin(ex)*cos(ey)/r_w^2 + lz*m_t*sin(ex)*sin(ez) + lz*m_t*sin(ey)*cos(ex)*cos(ez); -3*I_wi*r_b*cos(ey)*cos(ez)/(4*r_w^2) - lz*m_t*sin(ex)*sin(ey)*cos(ez) + lz*m_t*sin(ez)*cos(ex) -3*I_wi*r_b*sin(ex)*sin(ey)*cos(ez)/(4*r_w^2) + 3*I_wi*r_b*sin(ez)*cos(ex)/(4*r_w^2) - lz*m_t*sin(ex)*sin(ey)*sin(ez) - lz*m_t*cos(ex)*cos(ez) I_tx + 3*I_wi*r_b^2/(4*r_w^2) + lz^2*m_t*sin(ex)^2*sin(ey)^2*sin(ez)^2 + lz^2*m_t*sin(ex)^2*sin(ey)^2*cos(ez)^2 + lz^2*m_t*sin(ex)^2*cos(ey)^2 + lz^2*m_t*sin(ez)^2*cos(ex)^2 + lz^2*m_t*cos(ex)^2*cos(ez)^2 -lz^2*m_t*sin(ex)*sin(ey)*sin(ez)^2*cos(ex)*cos(ey) - lz^2*m_t*sin(ex)*sin(ey)*cos(ex)*cos(ey)*cos(ez)^2 + lz^2*m_t*sin(ex)*sin(ey)*cos(ex)*cos(ey) -lz^2*m_t*sin(ex)^2*sin(ey)*sin(ez)^2 - lz^2*m_t*sin(ex)^2*sin(ey)*cos(ez)^2 - lz^2*m_t*sin(ey)*sin(ez)^2*cos(ex)^2 - lz^2*m_t*sin(ey)*cos(ex)^2*cos(ez)^2; -0.75*I_wi*r_b*sin(ez)*cos(ey)/r_w^2 + lz*m_t*cos(ex)*cos(ey)*cos(ez) -0.75*I_wi*r_b*sin(ex)*sin(ey)*sin(ez)/r_w^2 - 0.75*I_wi*r_b*cos(ex)*cos(ez)/r_w^2 + lz*m_t*sin(ez)*cos(ex)*cos(ey) -lz^2*m_t*sin(ex)*sin(ey)*sin(ez)^2*cos(ex)*cos(ey) - lz^2*m_t*sin(ex)*sin(ey)*cos(ex)*cos(ey)*cos(ez)^2 + lz^2*m_t*sin(ex)*sin(ey)*cos(ex)*cos(ey) I_tx + 0.75*I_wi*r_b^2/r_w^2 + lz^2*m_t*sin(ey)^2*cos(ex)^2 + lz^2*m_t*sin(ez)^2*cos(ex)^2*cos(ey)^2 + lz^2*m_t*cos(ex)^2*cos(ey)^2*cos(ez)^2 lz^2*m_t*sin(ex)*sin(ez)^2*cos(ex)*cos(ey) + lz^2*m_t*sin(ex)*cos(ex)*cos(ey)*cos(ez)^2; 1.5*I_wi*r_b*sin(ey)/r_w^2 + lz*m_t*sin(ex)*cos(ez) - lz*m_t*sin(ey)*sin(ez)*cos(ex) -1.5*I_wi*r_b*sin(ex)*cos(ey)/r_w^2 + lz*m_t*sin(ex)*sin(ez) + lz*m_t*sin(ey)*cos(ex)*cos(ez) -lz^2*m_t*sin(ex)^2*sin(ey)*sin(ez)^2 - lz^2*m_t*sin(ex)^2*sin(ey)*cos(ez)^2 - lz^2*m_t*sin(ey)*sin(ez)^2*cos(ex)^2 - lz^2*m_t*sin(ey)*cos(ex)^2*cos(ez)^2 lz^2*m_t*sin(ex)*sin(ez)^2*cos(ex)*cos(ey) + lz^2*m_t*sin(ex)*cos(ex)*cos(ey)*cos(ez)^2 I_tz + 1.5*I_wi*r_b^2/r_w^2 + lz^2*m_t*sin(ex)^2*sin(ez)^2 + lz^2*m_t*sin(ex)^2*cos(ez)^2 + lz^2*m_t*sin(ey)^2*sin(ez)^2*cos(ex)^2 + lz^2*m_t*sin(ey)^2*cos(ex)^2*cos(ez)^2]
end