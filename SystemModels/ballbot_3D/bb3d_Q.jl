function bb3d_Q(ex, ey, ez)
	return [0.5*sqrt(2)*sin(ey)/r_w + 0.5*sqrt(2)*sin(ez)*cos(ey)/r_w sqrt(2)*sin(ey)/(2*r_w) - sqrt(2)*sin(ez)*cos(ey)/(4*r_w) - sqrt(6)*cos(ey)*cos(ez)/(4*r_w) sqrt(2)*sin(ey)/(2*r_w) - sqrt(2)*sin(ez)*cos(ey)/(4*r_w) + sqrt(6)*cos(ey)*cos(ez)/(4*r_w); 0.5*sqrt(2)*(sin(ex)*sin(ey)*sin(ez) + cos(ex)*cos(ez))/r_w - 0.5*sqrt(2)*sin(ex)*cos(ey)/r_w -sqrt(2)*(sin(ex)*sin(ey)*sin(ez) + cos(ex)*cos(ez))/(4*r_w) - sqrt(6)*(sin(ex)*sin(ey)*cos(ez) - sin(ez)*cos(ex))/(4*r_w) - sqrt(2)*sin(ex)*cos(ey)/(2*r_w) -sqrt(2)*(sin(ex)*sin(ey)*sin(ez) + cos(ex)*cos(ez))/(4*r_w) + sqrt(6)*(sin(ex)*sin(ey)*cos(ez) - sin(ez)*cos(ex))/(4*r_w) - sqrt(2)*sin(ex)*cos(ey)/(2*r_w); 0 sqrt(6)*r_b/(4*r_w) -sqrt(6)*r_b/(4*r_w); -0.5*sqrt(2)*r_b/r_w sqrt(2)*r_b/(4*r_w) sqrt(2)*r_b/(4*r_w); 0.5*sqrt(2)*r_b/r_w sqrt(2)*r_b/(2*r_w) sqrt(2)*r_b/(2*r_w)]
end